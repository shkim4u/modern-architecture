{"version":3,"sources":["components/ShoppingCart/shoppingCartReducer.js","components/ItemCard/ItemCard.js","APIUtils.js","workspace/pages/offer/OfferPage.js","workspace/pages/payment/orderReducer.js","workspace/pages/payment/LineItem.js","workspace/pages/payment/Invoice.js","workspace/pages/payment/PaymentPage.js","workspace/pageRoutes.js","workspace/pages/confirmation/ConfirmationPage.js","workspace/Header.js","workspace/Footer.js","components/ShoppingCart/CartItem.js","components/ShoppingCart/ShoppingCart.js","workspace/Workspace.js","workspace/requestStatusReducer.js","App.js","reportWebVitals.js","index.js"],"names":["initialState","basket","total","itemCount","ActionTypes","reducer","state","action","type","payload","newBasket","slice","basketItemIndex","map","basketItem","id","indexOf","push","quantity","subtotal","unitPrice","reduce","result","count","splice","ItemCard","item","dispatch","useDispatch","Card","className","CardMedia","image","imageUrl","title","CardContent","Typography","gutterBottom","variant","component","CardActions","Button","size","color","onClick","defaultOptions","headers","apiRoot","document","querySelector","baseUrl","undefined","callEndpoint","endpoint","options","method","charAt","mergedOptions","body","JSON","stringify","Headers","fetch","then","response","ok","json","responseBody","code","status","message","catch","error","_callEndpoint","getAttribute","length","OfferPage","endpoints","useContext","AppConfig","useState","items","setItems","useEffect","catalogue","index","orderId","clientCallbackUrl","amountPaid","LineItem","Invoice","validateCreditCardNumberLength","cardNumber","replaceAll","PaymentPage","history","useHistory","address","setAddress","city","setCity","postCode","setPostCode","setCardNumber","cardholderName","setCardholderName","expiry","setExpiry","ccv","setCCV","useSelector","store","cart","order","loading","submitting","callbackUrl","Promise","resolve","reject","socket","WebSocket","onopen","console","log","setTimeout","readyState","OPEN","send","close","Error","onmessage","event","data","parse","exception","onerror","onFormSubmission","shippingAddress","paymentDetail","placeOrder","submitPayment","onSubmit","preventDefault","onReset","window","location","href","FormControl","fullWidth","margin","TextField","name","label","value","onChange","target","helperText","test","validateCreditCardInput","blocks","match","join","formatCreditCardNumber","validateExpiry","formatExpiry","validateCCV","Alert","severity","AlertTitle","style","display","alignItems","disabled","CircularProgress","pageRoutes","path","pageContent","props","hideCart","Header","toggleNavMenu","fontSize","Badge","marginTop","badgeContent","vertical","Footer","CartItem","padding","borderBottom","flex","IconButton","Remove","Add","ShoppingCart","basketItems","Clear","WorkspaceBody","content","navGroup","contentProps","routes","selected","React","createElement","Workspace","drawerOpen","setDrawerOpen","open","route","exact","render","to","Drawer","anchor","onClose","regexp","RegExp","errors","matches","exec","requestName","loadingIndex","createContext","configureStore","composeEnhancers","composeWithDevTools","createStore","combineReducers","requestStatusReducer","cartReducer","orderReducer","applyMiddleware","thunk","App","Provider","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","root","getElementById","configNode","a","configSrc","config","innerHTML","parseConfig","ReactDOM","StrictMode"],"mappings":"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","file":"static/js/main.304e704c.chunk.js","sourcesContent":["const initialState = {\n  basket: [],\n  total: 0,\n  itemCount: 0\n}\n\nexport const ActionTypes = {\n  ADD_ITEM: \"addItem\",\n  REMOVE_ITEM: \"removeItem\",\n  REMOVE_ALL: \"removeAll\",\n  CLEAR_BASKET: \"clearBasket\"\n}\n\nexport const reducer = (state = initialState, action) => {\n  const { type, payload } = action;\n  switch(type) {\n    case ActionTypes.ADD_ITEM : {\n      const newBasket = state.basket.slice();\n      const basketItemIndex = newBasket.map(basketItem => basketItem.id).indexOf(payload.id);\n      if(basketItemIndex < 0) {\n        newBasket.push({\n          ...payload,\n          quantity: 1,\n          subtotal: payload.unitPrice\n        });\n      } else {\n        const basketItem = newBasket[basketItemIndex];\n        basketItem.quantity++;\n        basketItem.subtotal = basketItem.quantity * basketItem.unitPrice;\n      }\n      const total = newBasket.map(basketItem => basketItem.subtotal).reduce((result, subtotal) => (result + subtotal), 0);\n      const itemCount = newBasket.map(basketItem => basketItem.quantity).reduce((result, count) => (result + count), 0);\n      state = { basket: newBasket, total, itemCount };\n      break;\n    }\n    case ActionTypes.REMOVE_ITEM : {\n      const newBasket = state.basket.slice();\n      const basketItemIndex = newBasket.map(basketItem => basketItem.id).indexOf(payload.id);\n      if(basketItemIndex > -1) {\n        const basketItem = newBasket[basketItemIndex];\n        if(basketItem.quantity > 1) {\n          basketItem.quantity--;\n          basketItem.subtotal = basketItem.quantity * basketItem.unitPrice;\n        } else {\n          newBasket.splice(basketItemIndex, 1);\n        }\n        const total = newBasket.map(basketItem => basketItem.subtotal).reduce((result, subtotal) => (result + subtotal), 0);\n        const itemCount = newBasket.map(basketItem => basketItem.quantity).reduce((result, count) => (result + count), 0);\n        state = { basket: newBasket, total, itemCount}\n      }\n      break;\n    }\n    case ActionTypes.REMOVE_ALL : {\n      const newBasket = state.basket.slice();\n      const basketItemIndex = newBasket.map(basketItem => basketItem.id).indexOf(payload.id);\n      if(basketItemIndex > -1) {\n        newBasket.splice(basketItemIndex, 1);\n        const total = newBasket.map(basketItem => basketItem.subtotal).reduce((result, subtotal) => (result + subtotal), 0);\n        const itemCount = newBasket.map(basketItem => basketItem.quantity).reduce((result, count) => (result + count), 0);\n        state = { basket: newBasket, total, itemCount}\n      }\n      break;\n    }\n    case ActionTypes.CLEAR_BASKET: {\n      state = { basket: [], total: 0, itemCount: 0}\n      break;\n    }\n  }\n  return state;\n}\n","import React from \"react\";\nimport Button from \"@material-ui/core/Button\";\n\nimport \"./ItemCard.scss\";\nimport Card from \"@material-ui/core/Card\";\nimport CardMedia from \"@material-ui/core/CardMedia\";\nimport CardContent from \"@material-ui/core/CardContent\";\nimport Typography from \"@material-ui/core/Typography\";\nimport CardActions from \"@material-ui/core/CardActions\";\nimport {useDispatch} from \"react-redux\";\n\nimport { ActionTypes } from \"../ShoppingCart/shoppingCartReducer\"\n\nconst ItemCard = ({item}) => {\n  const dispatch = useDispatch();\n\n  const addItem = () => {\n    dispatch({\n      type: ActionTypes.ADD_ITEM,\n      payload: item\n    });\n  }\n\n  return (\n    <Card className=\"item-card\">\n      <div>\n        <CardMedia className=\"item-image\"\n          image={item.imageUrl}\n          title={item.title}\n        />\n        <CardContent className=\"item-detail\">\n          <Typography gutterBottom variant=\"h5\" component=\"h2\">\n            {item.title}\n          </Typography>\n          <span>${item.unitPrice}</span>\n        </CardContent>\n      </div>\n      <CardActions>\n        <Button size=\"small\" color=\"primary\" onClick={addItem}>\n          Add to cart\n        </Button>\n      </CardActions>\n    </Card>\n  )\n}\n\nexport default ItemCard;\n","const defaultOptions = {\n  headers: {\n    \"Content-Type\": \"application/json\"\n  }\n}\n\nconst apiRoot = document.querySelector(\"link[rel='api-root']\");\nlet baseUrl = undefined;\nif(apiRoot) {\n  baseUrl = apiRoot.getAttribute(\"href\");\n  if(baseUrl && baseUrl.charAt(baseUrl.length - 1) === \"/\") {\n    baseUrl = baseUrl.slice(0, baseUrl.length - 1);\n  }\n}\n\nfunction _callEndpoint(endpoint, options=defaultOptions, method=\"GET\") {\n  const mergedOptions = {...defaultOptions, ...options};\n  mergedOptions.method = method;\n\n  // TODO: work out better serialization\n  if(typeof mergedOptions.body === \"object\" && mergedOptions.headers) {\n    const contentType = mergedOptions.headers[\"Content-Type\"];\n    if (contentType === \"application/json\") {\n      mergedOptions.body = JSON.stringify(mergedOptions.body);\n    }\n  }\n\n  if(mergedOptions.headers) {\n    mergedOptions.headers = new Headers(mergedOptions.headers)\n  }\n\n  return fetch(endpoint, mergedOptions)\n    .then(response => {\n      if(!response.ok) {\n        return response.json().then(responseBody => {\n            throw {\n              code: response.status,\n              message: responseBody.message\n            }\n          });\n      } else {\n        return response;\n      }\n    })\n    .then(response => response.json())\n    .catch(error => {\n      throw error\n    });\n}\n\n\nexport function callEndpoint(endpoint, options, method) {\n  if(baseUrl && endpoint.charAt(0) === \"/\") {\n    endpoint = baseUrl + endpoint;\n  }\n  return _callEndpoint(endpoint, options, method);\n}\n","import React, { useEffect, useState, useContext } from \"react\";\nimport ItemCard from \"../../../components/ItemCard/ItemCard\";\nimport \"./OfferPage.scss\";\nimport {AppConfig} from \"../../../App\";\nimport { callEndpoint} from \"../../../APIUtils\";\n\nconst OfferPage = () => {\n  const { endpoints } = useContext(AppConfig);\n  const [items, setItems] = useState([]);\n\n  useEffect(() => {\n    callEndpoint(endpoints.catalogue)\n      .then(items => {\n        setItems(items);\n      });\n  }, []);\n  return (\n    <div className=\"page-offer\">\n      <div className=\"item-results\">\n        {\n          items.map((item, index) => <ItemCard key={index} item={item}/>)\n        }\n      </div>\n    </div>\n\n  );\n}\n\nexport default OfferPage;\n","const initialState = {\n  status: \"new\",\n  orderId: \"\",\n  message: \"\",\n  clientCallbackUrl: \"\"\n}\n\nexport const ActionTypes = {\n  PLACE_ORDER_REQUEST: \"placeOrderRequest\",\n  PLACE_ORDER_SUCCESS: \"placeOrderSuccess\",\n  PLACE_ORDER_FAIL: \"placeOrderFailure\",\n\n  PROCESS_ORDER_REQUEST: \"processOrderRequest\",\n  PROCESS_ORDER_SUCCESS: \"processOrderSuccess\",\n  PROCESS_ORDER_FAILURE: \"processOrderFailure\"\n}\n\nexport const reducer = (state = initialState, action) => {\n  const { type, payload} = action;\n  switch(type) {\n    case ActionTypes.PLACE_ORDER_SUCCESS: {\n      state = {\n        ...state,\n        status: payload.status ? payload.status : \"placed\",\n        clientCallbackUrl: payload.clientCallbackUrl,\n        orderId: payload.orderId\n      }\n      break;\n    }\n    case ActionTypes.PLACE_ORDER_FAIL: {\n      state = {\n        ...state,\n        status: payload.status ? payload.status : \"error\",\n        message: payload.message,\n        clientCallbackUrl: undefined\n      }\n      break;\n    }\n    case ActionTypes.PROCESS_ORDER_SUCCESS: {\n      state = {\n        ...state,\n        status: payload.status ? payload.status : \"success\",\n        orderId: payload.orderId,\n        amountPaid : payload.amountPaid\n      }\n      break;\n    }\n    case ActionTypes.PROCESS_ORDER_FAILURE: {\n      state = {\n        ...state,\n        status: payload.status ? payload.status : \"failed\",\n        orderId: payload.orderId,\n        message: payload.message,\n        clientCallbackUrl: undefined\n      }\n      break;\n    }\n  }\n  return state;\n}\n","import React from \"react\";\nimport \"./LineItem.scss\";\n\nconst LineItem = ({basketItem}) => {\n  return (\n    <li className=\"line-item\">\n      <span className=\"item-title\">{basketItem.title}</span>\n      <span className=\"item-quantity\"> x{basketItem.quantity}</span>\n      <span className=\"subtotal\">\n        ${basketItem.subtotal}\n      </span>\n    </li>\n  )\n}\nexport default LineItem;\n","import React from \"react\";\nimport LineItem from \"./LineItem\";\n\nconst Invoice = ({basket, total}) => {\n  return (\n    <ul>\n      { basket.map((basketItem, index) => <LineItem key={index} basketItem={basketItem}/>)}\n      <li key=\"total\" className=\"line-item total\">\n        <span className=\"total-label\">Total</span>\n        <span className=\"total-value\">${total}</span>\n      </li>\n    </ul>\n  )\n}\n\nexport default Invoice;\n","import React, {useContext, useEffect, useState} from \"react\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {useHistory} from \"react-router-dom\";\nimport { TextField, FormControl } from \"@material-ui/core\";\n\nimport \"./PaymentPage.scss\";\nimport Button from \"@material-ui/core/Button\";\n\nimport { callEndpoint} from \"../../../APIUtils\";\nimport {AppConfig} from \"../../../App\";\nimport {ActionTypes} from \"./orderReducer\";\nimport Invoice from \"./Invoice\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport { Alert, AlertTitle } from '@material-ui/lab';\n\nconst formatCreditCardNumber = cardNumber => {\n  cardNumber = cardNumber.replaceAll(\"-\", \"\");\n  const blocks = cardNumber.match(/.{1,4}/g);\n  if(blocks) {\n    return blocks.join(\"-\");\n  } else {\n    return \"\";\n  }\n}\n\nconst validateCreditCardNumberLength = cardNumber => {\n  cardNumber = cardNumber.replaceAll(\"-\", \"\");\n  return cardNumber.length < 17;\n}\n\nconst validateCreditCardInput = cardNumber => {\n  cardNumber = cardNumber.replaceAll(\"-\", \"\");\n  return cardNumber.length === 0 || /^\\d+$/.test(cardNumber);\n}\n\nconst formatExpiry = expiry => {\n  expiry = expiry.replaceAll(\"/\", \"\").slice(0, 4);\n  if(expiry.length > 2) {\n    return [expiry.slice(0, 2), \"/\", expiry.slice(2)].join('');\n  } else {\n    return expiry;\n  }\n}\n\nconst validateExpiry = expiry => {\n  expiry = expiry.replaceAll(\"/\", \"\");\n  return expiry.length === 0 || /^\\d+$/.test(expiry);\n}\n\nconst validateCCV = ccv => (ccv.length === 0 || /^\\d+$/.test(ccv));\n\n\nconst PaymentPage = () => {\n  const { endpoints } = useContext(AppConfig);\n  const dispatch = useDispatch();\n  const history = useHistory();\n\n  const [address, setAddress] = useState(\"123 Some Street\");\n  const [city, setCity] = useState(\"Seoul\");\n  const [postCode, setPostCode] = useState(\"2880\");\n\n  const [cardNumber, setCardNumber] = useState(\"\");\n  const [cardholderName, setCardholderName] = useState(\"\");\n  const [expiry, setExpiry] = useState(\"\");\n  const [ccv, setCCV] = useState(\"\");\n\n  const basket = useSelector(store => store.cart.basket);\n  const total = useSelector(store => store.cart.total);\n  const itemCount = useSelector(store => store.cart.itemCount);\n\n  const status = useSelector(store => store.order.status);\n  const message = useSelector(store => store.order.message);\n\n  const clientCallbackUrl = useSelector(store => store.order.clientCallbackUrl);\n  const orderId = useSelector(store => store.order.orderId);\n\n  const loading = useSelector(store => store.status.loading);\n  const submitting = loading.indexOf(\"placeOrder\") > -1 || loading.indexOf(\"processOrder\") > -1;\n\n  const listen = (callbackUrl) => {\n    const promise = new Promise((resolve, reject) => {\n      const socket = new WebSocket(callbackUrl);\n      socket.onopen = () => {\n        console.log(\"Listening to order status update at \", callbackUrl);\n\n        // Check order status if socket still open for 5 second mark\n        const pingForOrderStatus = () => {\n          if (socket.readyState === WebSocket.OPEN) {\n            console.log(\"Refreshing request for orderId:\", orderId);\n            socket.send(JSON.stringify({orderId: orderId}));\n          }\n        }\n        setTimeout(pingForOrderStatus, 5000);\n\n        // close websocket if websocket is still open for 1.5 minutes\n        const closeSocketDueToTimeout = () => {\n          if(socket.readyState === WebSocket.OPEN) {\n            socket.close();\n            reject(new Error(\"Websocket timeout\"));\n          }\n        }\n        setTimeout(closeSocketDueToTimeout, 90000);\n\n\n      }\n      socket.onmessage = (event) => {\n        try {\n          const data = JSON.parse(event.data);\n          console.log(\"Receive message: \", data);\n          if(data.status === \"success\") {\n            socket.close();\n            resolve(data);\n          } else if(data.status === \"failed\") {\n            socket.close();\n            reject(data);\n          }\n        } catch(exception) {\n          socket.close();\n          reject(exception);\n        }\n      }\n      socket.onerror = () => {\n        reject(new Error(\"Websocket error\"));\n      }\n    });\n    return promise;\n  }\n\n  useEffect(() => {\n    if(itemCount === 0) {\n      history.push(\"/\");\n    }\n  }, []);\n\n  useEffect(() => {\n    if(status === \"success\" || status === \"processed\") {\n      history.push(\"/confirmation\");\n    }\n  }, [status]);\n\n  useEffect(() => {\n    if(clientCallbackUrl) {\n      dispatch({ type: ActionTypes.PROCESS_ORDER_REQUEST });\n      listen(clientCallbackUrl)\n        .then(data => {\n          dispatch({\n            type: ActionTypes.PROCESS_ORDER_SUCCESS,\n            payload: data\n          });\n        })\n        .catch(error => {\n          dispatch({\n            type: ActionTypes.PROCESS_ORDER_FAILURE,\n            payload: error\n          });\n        });\n    }\n  }, [clientCallbackUrl]);\n\n  const submitPayment = () => {\n    const payload = {\n      basket: basket.map(basketItem => ({\n        id: basketItem.id, title: basketItem.title, quantity: basketItem.quantity\n      })),\n      shippingAddress: {\n        address, city, postCode\n      },\n      paymentDetail: {\n        cardNumber, cardholderName, expiry, ccv\n      }\n    }\n    dispatch({\n      type: ActionTypes.PLACE_ORDER_REQUEST\n    });\n\n    return dispatch => {\n      callEndpoint(endpoints.placeOrder, { body: payload }, \"POST\")\n        .then(data => {\n          dispatch({\n            type: ActionTypes.PLACE_ORDER_SUCCESS,\n            payload: {\n              clientCallbackUrl: data.clientCallbackUrl,\n              orderId: data.orderId\n            }\n          });\n        })\n        .catch(error => {\n          dispatch({\n            type: ActionTypes.PLACE_ORDER_FAIL,\n            payload: { message: error.message }\n          });\n        });\n    }\n  }\n\n  const onFormSubmission = () => {\n    dispatch(submitPayment());\n  }\n\n  const cancel = () => {\n    //history.push(\"/\");\n    window.location.href = \"/\";\n  }\n\n  return (\n    <div className=\"page-payment\">\n      <div className=\"side-bar\">\n        <Invoice basket={basket} total={total}/>\n      </div>\n\n      <div className=\"main-content\">\n        <form\n          onSubmit={(event) => {\n            event.preventDefault();\n            onFormSubmission(event);\n            return false;\n          }}\n          onReset={(event) => {\n            cancel();\n            event.preventDefault();\n          }}>\n          <h3>Shipping Address</h3>\n          <FormControl className=\"address\" fullWidth margin=\"normal\">\n            <TextField name=\"address\" label=\"Address\" variant=\"outlined\"\n                       value={address} onChange={(event) => { setAddress(event.target.value)}} />\n          </FormControl>\n          <FormControl className=\"city\" margin=\"normal\">\n            <TextField name=\"city\" label=\"City\" variant=\"outlined\"\n              value={city} onChange={(event) => { setCity(event.target.value)}}/>\n          </FormControl>\n          <FormControl className=\"postCode\" margin=\"normal\">\n            <TextField name=\"postCode\" label=\"Post Code\" variant=\"outlined\"\n              value={postCode} onChange={(event) => { setPostCode(event.target.value)}}/>\n          </FormControl>\n\n          <h3>Payment Details</h3>\n          <FormControl className=\"cardNumber\" fullWidth margin=\"normal\">\n            <TextField name=\"cardNumber\" label=\"Card Number\" variant=\"outlined\"\n                       error={!validateCreditCardNumberLength(cardNumber)}\n                       helperText={!validateCreditCardNumberLength(cardNumber) ? \"Credit card number too long\" : null}\n              value={cardNumber} onChange={\n                (event) => {\n                  if(validateCreditCardInput(event.target.value)) {\n                    setCardNumber(formatCreditCardNumber(event.target.value));\n                  }\n                }}/>\n          </FormControl>\n          <FormControl className=\"cardholderName\" margin=\"normal\">\n            <TextField name=\"cardholderName\" label=\"Cardholder Name\" variant=\"outlined\"\n              value={cardholderName} onChange={(event) => { setCardholderName(event.target.value)}}/>\n          </FormControl>\n          <FormControl className=\"expiry\" margin=\"normal\">\n            <TextField name=\"expiry\" label=\"Expiry Date\" variant=\"outlined\"\n              value={expiry} onChange={(event) => {\n                if(validateExpiry(event.target.value)) {\n                  setExpiry(formatExpiry(event.target.value))}\n                }\n              }/>\n          </FormControl>\n          <FormControl className=\"ccv\" margin=\"normal\">\n            <TextField name=\"ccv\" label=\"CCV\" variant=\"outlined\"\n              value={ccv} onChange={(event) => {\n                if(validateCCV(event.target.value)) {\n                  setCCV(event.target.value.slice(0,3))\n                }\n              }}\n            />\n          </FormControl>\n\n          { status === \"error\" || status === \"failed\" ? (\n            <Alert severity=\"error\" className=\"error\">\n              <AlertTitle>{message}</AlertTitle>\n            </Alert>\n          ) : null}\n\n          { status === \"placed\" ? (\n              <Alert severity=\"success\">\n                <AlertTitle>Your order has been submitted</AlertTitle>\n                Awaiting order processing status update for order reference:<br/>\n                <b>{orderId}</b>\n              </Alert>\n          ) : null}\n\n          <div className=\"buttons\">\n            <span style={{display: \"flex\", alignItems:\"center\"}}>\n              <Button type=\"submit\" color=\"primary\" size=\"large\" variant=\"contained\"\n                      disabled={submitting}>\n                Confirm Payment\n              </Button>\n              <CircularProgress size={24} className={`progress ${submitting?\"submitting\":null}`}/>\n            </span>\n\n            <Button type=\"reset\" size=\"large\" variant=\"contained\" disabled={submitting}>\n              Cancel\n            </Button>\n          </div>\n        </form>\n      </div>\n\n    </div>\n  );\n}\n\nexport default PaymentPage;\n","import OfferPage from \"./pages/offer/OfferPage\";\nimport PaymentPage from \"./pages/payment/PaymentPage\";\nimport ConfirmationPage from \"./pages/confirmation/ConfirmationPage\";\n\nexport const pageRoutes = [\n  {\n    path: \"/\",\n    label: \"offer\",\n    pageContent: OfferPage\n  },\n  {\n    path: \"/payment\",\n    label: \"payment\",\n    pageContent: PaymentPage,\n    props: {\n      hideCart: true\n    }\n  },\n  {\n    path: \"/confirmation\",\n    label: \"confirmation\",\n    pageContent: ConfirmationPage,\n    props: {\n      hideCart: true\n    }\n  }\n]\n\nexport const defaultRoute = \"/\";\n","import React, { useEffect } from \"react\";\n\nimport \"./ConformationPage.scss\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport Button from \"@material-ui/core/Button\";\nimport {useHistory} from \"react-router-dom\";\nimport {ActionTypes} from \"../../../components/ShoppingCart/shoppingCartReducer\";\n\nconst ConfirmationPage = () => {\n  const history = useHistory();\n  const orderId = useSelector(store => store.order.orderId);\n  const amountPaid = useSelector(store => store.order.amountPaid);\n\n  const dispatch = useDispatch();\n  useEffect(() => {\n    dispatch({\n      type: ActionTypes.CLEAR_BASKET\n    });\n  }, []);\n\n  return (\n    <div className=\"confirmation\">\n      <p>\n        Thank you for shopping at Octank Awsome Pets. You have paid an amount of ${amountPaid}\n      </p>\n      <p>\n        Your order reference is <b>{orderId}</b>.\n      </p>\n\n      <div className=\"buttons\">\n        <Button color=\"primary\" size=\"medium\" variant=\"contained\"\n                onClick={() => { window.location.href = \"/\"}}>\n          Back to shopping\n        </Button>\n      </div>\n    </div>);\n}\n\nexport default ConfirmationPage;\n","import React from \"react\";\nimport Button from \"@material-ui/core/Button\";\nimport { ShoppingCartOutlined as ShoppingCartIcon } from \"@material-ui/icons\";\nimport Badge from \"@material-ui/core/Badge\";\nimport {useSelector} from \"react-redux\";\nimport {useHistory} from \"react-router-dom\";\n\nfunction Header(props) {\n  const history = useHistory();\n  const { toggleNavMenu, hideCart, ...rest} = props;\n  const itemCount = useSelector(store => store.cart.itemCount);\n\n  return (\n    <header>\n      <div className=\"header-content\">\n        <div className=\"header-section\">\n          <a className=\"logo\" href=\"#\" onClick={() => {\n            history.push(\"/\");\n            return false;\n          }}>\n            <span className=\"narrow\">\n              Awsome\n            </span>\n            <span className=\"bold\">\n              Pets\n            </span>\n          </a>\n        </div>\n        <div className=\"header-section\">\n          {!hideCart ? (\n            <Button onClick={toggleNavMenu}>\n              <ShoppingCartIcon style={{ fontSize: 30 }}/>\n              <Badge\n                style={{marginTop: 16}}\n                badgeContent={itemCount}\n                color=\"secondary\" vertical=\"bottom\"/>\n            </Button>\n          ) : null}\n        </div>\n      </div>\n    </header>\n  );\n}\n\nexport default Header;\n","import React from \"react\";\n\nfunction Footer(props) {\n  return (\n    <footer>\n    </footer>\n  );\n}\n\nexport default Footer;\n","import React from \"react\";\nimport { useDispatch } from \"react-redux\";\n\nimport \"./CartItem.scss\";\nimport { DeleteOutline as Delete } from \"@material-ui/icons\";\nimport CardMedia from \"@material-ui/core/CardMedia\";\nimport { Add, Remove } from \"@material-ui/icons\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport {ActionTypes} from \"./shoppingCartReducer\";\n\nconst CartItem = ({basketItem} ) => {\n  const dispatch = useDispatch();\n\n  const increment = () => {\n    dispatch({\n      type: ActionTypes.ADD_ITEM,\n      payload: basketItem\n    });\n  }\n\n  const decrement = () => {\n    dispatch({\n      type: ActionTypes.REMOVE_ITEM,\n      payload: basketItem\n    });\n  }\n\n  const remove = () => {\n    dispatch({\n      type: ActionTypes.REMOVE_ALL,\n      payload: basketItem\n    });\n  }\n\n  return (\n    <div className=\"cart-item\">\n      <CardMedia className=\"item-image\" image={basketItem.imageUrl} title={basketItem.title}/>\n      <div style={{\n        padding: 8,\n        borderBottom: \"1px solid #ccc\",\n        flex: \"1 1 auto\",\n        margin: 8\n      }}>\n        <div className=\"item-detail\">\n          <h4>{basketItem.title}</h4>\n          <span className=\"subtotal\">${basketItem.subtotal}</span>\n        </div>\n        <div className=\"item-quantity\">\n          <span>\n            <IconButton size=\"small\" onClick={decrement}>\n              <Remove/>\n            </IconButton>\n            <span>{basketItem.quantity}</span>\n            <IconButton size=\"small\" onClick={increment}>\n              <Add/>\n            </IconButton>\n          </span>\n          <IconButton size=\"small\" onClick={remove}>\n            <Delete/>\n          </IconButton>\n        </div>\n      </div>\n    </div>\n  )\n}\n\nexport default CartItem;\n","import React, { useEffect } from \"react\";\nimport {useSelector} from \"react-redux\";\n\nimport \"./ShoppingCart.scss\";\nimport CartItem from \"./CartItem\";\nimport {Button} from \"@material-ui/core\";\nimport {Clear} from \"@material-ui/icons\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport {useHistory} from \"react-router-dom\";\n\nconst ShoppingCart = ({ close }) => {\n\n  const history = useHistory();\n\n  const basketItems = useSelector(store => store.cart.basket);\n  const total = useSelector(store => store.cart.total);\n  const itemCount = useSelector(store => store.cart.itemCount);\n\n  const checkout = () => {\n    close();\n    history.push(\"payment\");\n  }\n\n  return (\n    <div className=\"shopping-cart\">\n      <div className=\"header\">\n        <IconButton onClick={close}>\n          <Clear/>\n        </IconButton>\n      </div>\n\n      {basketItems.length > 0 ? (\n        <div>\n          <div className=\"basket\">\n            {basketItems.map((basketItem, index) =>\n              <CartItem key={index} basketItem={basketItem}/>)}\n          </div>\n          <div className=\"total-row\">\n            <span>Total</span>\n            <span className=\"total\">${total}</span>\n          </div>\n        </div>\n      ) : (\n        <div className=\"empty-basket\">\n          Your shopping cart is empty\n        </div>\n      )}\n\n      <div className=\"actions\">\n        <Button className=\"checkout-button\" disabled={itemCount < 1}\n          variant=\"contained\" color=\"primary\" size=\"medium\" onClick={checkout }>\n          Checkout\n        </Button>\n      </div>\n    </div>\n\n  );\n}\n\nexport default ShoppingCart;\n","import React, { useState } from \"react\";\nimport { Switch, Route, Redirect } from \"react-router-dom\";\nimport { Drawer } from \"@material-ui/core\";\n\nimport {pageRoutes, defaultRoute} from \"./pageRoutes\";\nimport Header from \"./Header.js\";\nimport Footer from \"./Footer.js\";\n\nimport './workspace.scss';\nimport ShoppingCart from \"../components/ShoppingCart/ShoppingCart\";\n\nfunction Workspace() {\n  const [drawerOpen, setDrawerOpen] = useState(false);\n\n  const toggleNavMenu = (open) => {\n    if(open === undefined) {\n      open = !drawerOpen;\n    }\n    setDrawerOpen(open);\n  };\n\n  return (\n    <div>\n      <Switch>\n        {\n          pageRoutes.map((route, index) =>\n            <Route key={index}\n                   path={route.path}\n                   exact={route.exact !== undefined ? route.exact : (!(route.props && route.props.routes))}\n                   render={() =>\n                     React.createElement(WorkspaceBody, {...route.props, content: route.pageContent, toggleNavMenu: toggleNavMenu})\n                   }\n            />)\n        }\n        <Route exact path=\"/\">\n          <Redirect to={defaultRoute} />\n        </Route>\n      </Switch>\n      <Footer/>\n      <Drawer anchor=\"right\" open={drawerOpen} onClose={() => {toggleNavMenu(false)} }>\n        <ShoppingCart close={() => { toggleNavMenu(false)}}/>\n      </Drawer>\n\n    </div>\n  )\n}\n\nfunction WorkspaceBody(props) {\n  const { content, hideCart, navGroup, toggleNavMenu, ...contentProps} = props;\n  return (\n    <>\n      <Header routes={pageRoutes} selected={navGroup} toggleNavMenu={toggleNavMenu} hideCart={hideCart}/>\n      <div className=\"workspace-content\">\n        { React.createElement(content, contentProps) }\n      </div>\n    </>\n  )\n}\n\nexport default Workspace;\n","const regexp = new RegExp(\"(.*)(Request|Success|Failure)\");\n\nexport const reducer = (state = { loading: [], errors: {}}, action) => {\n  const { type, payload } = action;\n  const matches = regexp.exec(type);\n  if(!matches) {\n    return state;\n  }\n\n  const [, requestName, status] = matches;\n  const loadingIndex = state.loading.indexOf(requestName);\n  if(status === \"Request\") {\n    if(loadingIndex === -1) {\n      return {\n        ...state,\n        loading: [...state.loading, requestName]\n      }\n    } else {\n      return state;\n    }\n  } else {\n    if(loadingIndex > -1) {\n      state.loading.splice(loadingIndex, 1);\n    }\n    const errors = {...state.errors};\n    if(status === \"Success\") {\n      delete errors[requestName];\n    } else if(status === \"Failure\") {\n      errors[requestName] = payload;\n    }\n    return {\n      ...state,\n      loading: [...state.loading],\n      errors\n    };\n  }\n}\n\nexport default reducer;\n","import React from 'react';\nimport Workspace from './workspace/Workspace';\nimport { Provider } from \"react-redux\";\nimport thunk from \"redux-thunk\";\nimport {applyMiddleware, combineReducers, createStore} from \"redux\";\nimport { composeWithDevTools } from \"redux-devtools-extension\";\nimport { reducer as requestStatusReducer } from \"./workspace/requestStatusReducer\";\nimport { reducer as cartReducer} from \"./components/ShoppingCart/shoppingCartReducer\";\nimport { reducer as orderReducer} from \"./workspace/pages/payment/orderReducer\";\n\nimport { HashRouter as Router } from \"react-router-dom\";\n\nexport const AppConfig = React.createContext({});\n\nfunction configureStore() {\n  const composeEnhancers = composeWithDevTools({});\n  const store = createStore(combineReducers({\n    \"status\" : requestStatusReducer,\n    \"cart\": cartReducer,\n    \"order\": orderReducer\n  }), composeEnhancers(applyMiddleware(thunk)));\n  return store;\n}\n\nfunction App(props) {\n  return (\n    <AppConfig.Provider value={props} >\n      <Provider store={configureStore()}>\n        <Router>\n          <Workspace/>\n        </Router>\n      </Provider>\n    </AppConfig.Provider>\n  );\n}\n\nexport default App;\n","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.scss';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nconst root = document.getElementById('root');\nconst configNode = root.querySelector('[rel=\"configuration\"]');\n\nconst parseConfig = async (configNode) => {\n  const configSrc = configNode.getAttribute(\"src\");\n  if(configSrc) {\n    const response = await fetch(configSrc);\n    const config = await response.json();\n    return config;\n  } else {\n    return JSON.parse(configNode.innerHTML)\n  }\n}\n\nconst promise = configNode ? parseConfig(configNode) : Promise.resolve({});\npromise.then(config => {\n  ReactDOM.render(\n    <React.StrictMode>\n      <App {...config} />\n    </React.StrictMode>, root);\n});\n\n\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}
